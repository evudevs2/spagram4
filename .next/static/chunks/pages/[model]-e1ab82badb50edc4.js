(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9714],{100:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[model]",function(){return t(7485)}])},7485:function(e,a,t){"use strict";t.r(a);var s=t(5893),l=t(7294),i=t(9008),o=t.n(i),n=t(8894);t(1664);var r=t(1163),c=t(8433),d=t(4174),m=t(3033),u=t(3760),h=t(698);a.default=function(){let[e,a]=(0,l.useState)({name:"",email:"",phone:"",address:"",city:"",zip:"",password:"",selected_model:""}),[t,i]=(0,l.useState)({customer_id:"",model_id:"",service_address:"",service_type:"",service_time:"",amount_received:"",cardid:"",status:""}),[p,x]=(0,l.useState)(!0),[g,j]=(0,l.useState)(!1),[v,y]=(0,l.useState)(!1),[f,_]=(0,l.useState)(null),[S,b]=(0,l.useState)(null),[w,C]=(0,l.useState)(null),[N,k]=(0,l.useState)(!0),[D,P]=(0,l.useState)(null),[E,Z]=(0,l.useState)(!1),[I,z]=(0,l.useState)(null),[L,T]=(0,l.useState)(""),[A,F]=(0,l.useState)(!0),[M,U]=(0,l.useState)(null),[R,q]=(0,l.useState)(!1),[B,Y]=(0,l.useState)(!0),[$,O]=(0,l.useState)(),[X,G]=(0,l.useState)(!1),[W,H]=(0,l.useState)(!1),[J,K]=(0,l.useState)(!1),[Q,V]=(0,l.useState)(!1),[ee,ea]=(0,l.useState)(!1),[et,es]=(0,l.useState)(!1),[el,ei]=(0,l.useState)(null),[eo,en]=(0,l.useState)(["9 am","10 am","11 am","12 pm","1 pm","2 pm","3 pm","4 pm","5 pm","6 pm","7 pm","8 pm","9 pm","10 pm","11 pm","12 am","1 am","2 am","3 am","4 am","5 am","6 am","7 am","8 am"]),[er,ec]=(0,l.useState)({email:"",password:""}),ed=t=>{a({...e,[t.target.name]:t.target.value})};(0,r.useRouter)();let em="",eu=e=>{console.log("calltype selector func called");let a=e.target.value;if(O(a),"inCall"==a){G(!0),H(!1);let e=w[0].incall_location;i({...t,service_address:e,service_type:"inCall"})}else H(!0),G(!1)},eh=e=>{K(e.target.value),i({...t,service_address:e.target.value,service_type:"outCall"})},ep=t=>{a({...e,[t.target.name]:t.target.value})},ex=e=>(.1*parseFloat(e)).toFixed(2),eg=async e=>{e.preventDefault();try{console.log("incall location",w[0].incall_location,X),w[0].incall_location,console.log("orderdata before confirmorder ",t);let e=await c.Z.post("https://tsm.spagram.com/api/confirmorder.php",t);if(console.log("order retured",e.data),"1"==e.data.success){let{token:a}=e.data;localStorage.setItem("customertoken",a),window.location.href="/cardsaved"}else window.location.href="/cardnotsaved"}catch(e){console.error(e)}},ej=async a=>{a.preventDefault();try{let a=await c.Z.post("https://tsm.spagram.com/api/login-customer.php",e);if(console.log("rest",a.data),"1"==a.data.success){let{token:e}=a.data;console.log("retured after login",a.data),localStorage.setItem("customertoken",e),Z(!0),i({...t,customer_id:e})}else T("Email/Password is not correct. Please try again or click to the button below to register. ")}catch(e){console.error(e)}},ev=async s=>{s.preventDefault(),k(!0),_("");try{e.selected_model=S;let s=await c.Z.post("https://tsm.spagram.com/api/register-customer.php",e);if(console.log("client data",e),console.log("rest",s.data),"1"==s.data.success){let{customerdbid:e,cardsaved:l}=s.data;localStorage.setItem("customerdbid",e),localStorage.setItem("cardsaved",l),localStorage.setItem("price",t.amount_received),i({...t,customer_id:e}),_("Your registration is successful"),ea(!0),a({name:"",email:"",phone:"",address:"",city:"",zip:"",password:""}),console.log("insertedcustomer id",e),k(!1)}else k(!1),_("Error! Please contact support.")}catch(e){console.error(e)}},ey=()=>{let e=localStorage.getItem("customertoken");console.log("h",e),e&&(Z(!0),i({...t,customer_id:e}))},ef=e=>{let a=new Date(e);a.setDate(a.getDate()+1);let t=a.getDate(),s=a.getMonth()+1+"/"+t+"/"+a.getFullYear();y(s),console.log("Tomorrow:",s),eb(S,s)},e_=()=>{let e=new Date,a=e.getDate(),t=e.getMonth()+1+"/"+a+"/"+e.getFullYear();return y(t),t},eS=e=>{let a=new Date(e);a.setDate(a.getDate()-1);let t=a.getDate(),s=a.getMonth()+1+"/"+t+"/"+a.getFullYear();y(s),console.log("Tomorrow:",s),eb(S,s)},eb=async(e,a)=>{try{let t="";if(""==a){let e=new URLSearchParams(em);t=e.get("date"),y(t),y(e.get("time"))}else t=a,y(a);console.log("cdate",t);let s=await c.Z.get("https://tsm.spagram.com/api/availability.php?modelid="+e+"&date="+t);if(console.log("availdata","https://tsm.spagram.com/api/availability.php?modelid="+e+"&date="+t,s.data),U(s.data),"1"==s.data.success){let{token:e}=s.data}}catch(e){console.error(e)}},ew=[];eo.map(e=>{M&&M.includes(e)?ew.push((0,s.jsxs)("div",{onClick:()=>eC(e),className:"available",children:[" ",e," "]})):ew.push((0,s.jsxs)("div",{className:"notavailable",children:[" ",e," "]}))});let eC=e=>{console.log("call type",J);let a=!0;if((void 0==$||"inCall/outCall"==$)&&(a=!1,x(!1)),"outCall"==$&&!1==J&&(a=!1,x(!1)),a){j(e);let a=ex(w[0].price),s="";s=""!=v?v:e_(),console.log("todays date",e_()),i({...t,service_time:s+", "+e,amount_received:a,cardid:"",status:"Initiated"})}};return(0,l.useEffect)(()=>{em=localStorage.getItem("singleModelApiUrl");let e=new URLSearchParams(em);ei(e.get("date")),console.log("ap url",em),ey();let a=async()=>{try{let e=await c.Z.get(em);C(e.data),new URLSearchParams(em);let a=em.split("=")[1];console.log("modid, di",a),a=a.split("&")[0],console.log("modid, di",a),b(a),i({...t,model_id:a}),console.log("surl",em),console.log("sdata",e.data),eb(a,""),P(null)}catch(e){P(e.message),C(null)}finally{k(!1)}};console.log("date and time",v,"---",g),a()},[em]),(0,s.jsxs)(n.Z,{children:[(0,s.jsx)(o(),{children:(0,s.jsx)("title",{children:" Book a model "})}),(0,s.jsxs)("div",{className:"bookingpage",children:[(0,s.jsxs)("div",{className:"modelInfoCnt",children:[(0,s.jsx)("h1",{children:"   "}),(0,s.jsx)("h1",{children:"   "}),N&&(0,s.jsx)("div",{children:"Loading..."}),D&&(0,s.jsx)("div",{children:"There is a problem fetching the post data - ".concat(D)}),w&&(0,s.jsx)(d.Z,{...w}),(0,s.jsxs)("div",{class:"gallery",children:[" ",(0,s.jsx)("h1",{children:"  "})," "]}),(0,s.jsx)(h.Z,{})]}),g?(0,s.jsx)("div",{className:"forms",children:(0,s.jsx)("div",{children:E?(0,s.jsxs)("div",{className:"order-box",children:[(0,s.jsxs)("div",{className:"order-summary",children:[(0,s.jsxs)("p",{children:[" Selected Date/Time: ",(0,s.jsxs)("strong",{children:[" ",""==v?e_():v," | ",g," "]})," ",(0,s.jsx)("span",{className:"anchor",onClick:()=>j(!1),children:" Change "})," "]}),(0,s.jsxs)("p",{children:[" Price: $",ex(w[0].price)," (10% of $",w[0].price," )  "]})]}),(0,s.jsxs)("p",{children:[" Use the Saved card "," ","  "]}),(0,s.jsx)("a",{onClick:()=>q(!0),children:" Use a new debit/credit card "}),R?(0,s.jsx)("div",{className:"cardform",children:(0,s.jsx)(u.Z,{})}):"",(0,s.jsx)("br",{}),(0,s.jsx)("a",{className:"button",onClick:eg,children:" Reserve the Appointment   "}),(0,s.jsxs)("p",{children:[" ",f," "]})]}):(0,s.jsx)("div",{className:"col2 bookarea",children:A?(0,s.jsxs)("div",{className:"registration-container",children:[(0,s.jsxs)("p",{className:"selected_label",children:["Selected date: ",v||el,", Time: ",g," ",(0,s.jsx)("span",{className:"anchor",onClick:()=>j(!1),children:" Change "}),"  "]}),(0,s.jsxs)("form",{onSubmit:ej,children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:" Login to Book an Appointment "}),(0,s.jsx)("label",{children:"Email:"}),(0,s.jsx)("input",{type:"email",id:"email",name:"email",onChange:ed,required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{children:"Password:"}),(0,s.jsx)("input",{type:"password",id:"password",name:"password",onChange:ed,required:!0})]}),(0,s.jsx)("button",{className:"button",type:"submit",children:"Submit"}),(0,s.jsxs)("p",{className:"message",children:[" ",I]})]}),(0,s.jsxs)("p",{children:[" ",L," "]}),(0,s.jsx)("div",{className:"button",onClick:()=>F(!1),children:" Not a member? Click to register "})]}):ee?(0,s.jsxs)("div",{className:"registration-container",children:[(0,s.jsx)("h3",{children:" Enter your card details "}),(0,s.jsx)("p",{children:" We will save your card in a Square secure server and charge you after the model accept your request. Please use the same zip you entered you zip field of previous step.  "}),(0,s.jsx)(u.Z,{customer_id:t.customer_id,model_id:t.model_id,service_address:t.service_address,service_type:t.service_type,service_time:t.service_time,price:t.amount_received,showSuccessPage:et})]}):(0,s.jsxs)("div",{className:"registration-container",children:[(0,s.jsx)("h2",{children:" Fill the form "}),(0,s.jsxs)("form",{onSubmit:ev,children:[(0,s.jsx)("label",{for:"name",children:"Name:"}),(0,s.jsx)("input",{type:"text",id:"name",onChange:ep,name:"name",value:e.name}),(0,s.jsx)("label",{for:"email",children:"Email:"}),(0,s.jsx)("input",{type:"email",id:"email",onChange:ep,name:"email",value:e.email}),(0,s.jsx)("label",{for:"phone",children:"Phone: (Don't add country code +1, don't add white space ) "}),(0,s.jsx)("input",{type:"tel",id:"phone",onChange:ep,name:"phone",value:e.phone}),(0,s.jsx)("label",{for:"address",children:" Address:"}),(0,s.jsx)("textarea",{id:"address",onChange:ep,name:"address",value:e.address}),(0,s.jsx)("label",{for:"city",children:"City:"}),(0,s.jsx)("input",{type:"text",id:"city",onChange:ep,name:"city",value:e.city}),(0,s.jsx)("label",{for:"zip",children:"Zip:"}),(0,s.jsx)("input",{type:"text",id:"zip",onChange:ep,name:"zip",value:e.zip}),(0,s.jsx)("label",{for:"name",children:"Create Password:"}),(0,s.jsx)("input",{type:"password",id:"password",onChange:ep,name:"password",value:e.password}),(0,s.jsx)("input",{type:"hidden",id:"selected_model",name:"selected_model",value:S}),(0,s.jsx)("button",{className:"button",type:"submit",children:"Submit"}),N&&(0,s.jsx)(m.Z,{}),(0,s.jsxs)("h2",{children:[" ",f," "]})]}),(0,s.jsx)("div",{className:"button",onClick:()=>F(!0),children:" Member? Click to login "})]})})})}):(0,s.jsxs)("div",{className:"date-selector",children:[(0,s.jsxs)("h2",{className:"mktitle",children:[" Make an Appointment with ",w&&w[0].name," "]}),(0,s.jsxs)("p",{className:"smallfont",children:[" Booking fee is $",w&&ex(w[0].price)," (10% of $",w&&w[0].price,")  "]}),(0,s.jsx)("p",{class:p?" ":"warnlable",children:" Select Call type "}),w&&(()=>{let e=w[0].location_type,a=e.split(",");return(0,s.jsxs)("div",{className:"calltypeCnt",children:[(0,s.jsxs)("div",{className:"calltypes",children:[" ",a.length<2?(0,s.jsxs)("select",{class:p?" ":"warn",onChange:eu,children:[(0,s.jsx)("option",{children:"inCall/outCall"}),(0,s.jsx)("option",{children:a[0]})]}):(0,s.jsxs)("select",{class:p?" ":"warn",onChange:eu,children:[(0,s.jsx)("option",{children:"inCall/outCall"}),(0,s.jsx)("option",{children:a[0]}),(0,s.jsx)("option",{children:a[1]})]}),"  "]}),(0,s.jsxs)("div",{children:[" ",$&&"inCall"==$?" Incall Location: "+w[0].incall_location:""," "]}),(0,s.jsxs)("div",{children:[" ",$&&"outCall"==$?(0,s.jsxs)("div",{children:[" ",(0,s.jsx)("input",{type:"text",class:p?" ":"warn",onChange:eh,placeholder:"Enter Outcall Location",name:"outcall_location"})," "]}):""," "]}),(0,s.jsx)("div",{children:"  "})]})})(),(0,s.jsxs)("div",{className:"date-changer",children:[(0,s.jsx)("a",{onClick:()=>eS(v||el),children:" Back \xa0\xa0 "}),(0,s.jsxs)("strong",{children:["  ",v||el," "]}),(0,s.jsx)("a",{onClick:()=>ef(v||el),children:" \xa0\xa0 Next "})]}),(0,s.jsx)("div",{children:" Select Green box. if All is booked then click next button above "}),(0,s.jsx)("div",{className:"timeCardCnt",children:ew})]})]})]})}}},function(e){e.O(0,[1664,5291,8433,959,6148,2328,9774,2888,179],function(){return e(e.s=100)}),_N_E=e.O()}]);